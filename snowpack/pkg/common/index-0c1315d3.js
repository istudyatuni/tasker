import{n as f,s as m,r as q,a as w,i as x}from"./index-4c6244e8.js";const o=[];function z(e,i){return{subscribe:_(e,i).subscribe}}function _(e,i=f){let u;const t=new Set;function b(n){if(w(e,n)&&(e=n,u)){const r=!o.length;for(const s of t)s[1](),o.push(s,e);if(r){for(let s=0;s<o.length;s+=2)o[s][0](o[s+1]);o.length=0}}}function l(n){b(n(e))}function a(n,r=f){const s=[n,r];return t.add(s),t.size===1&&(u=i(b)||f),n(e),()=>{t.delete(s),t.size===0&&(u(),u=null)}}return{set:b,update:l,subscribe:a}}function A(e,i,u){const t=!Array.isArray(e),b=t?[e]:e,l=i.length<2;return z(u,a=>{let n=!1;const r=[];let s=0,d=f;const g=()=>{if(s)return;d();const c=i(t?r[0]:r,a);l?a(c):d=x(c)?c:f},h=b.map((c,p)=>m(c,y=>{r[p]=y,s&=~(1<<p),n&&g()},()=>{s|=1<<p}));return n=!0,g(),function(){q(h),d()}})}export{A as d,_ as w};
