import{derived as c,writable as l}from"../../snowpack/pkg/svelte/store.js";import{settings as u}from"./settings.js";function p(){const{subscribe:n,set:o,update:s}=l([]);return{subscribe:n,set:o,update:(e,t)=>s(i=>{const r=i.findIndex(d=>d.task_id===e);if(r!==-1)return i[r]={...t},i;console.error("Not found task with id ",e)}),finish:(e,t)=>s(i=>{const r=i.findIndex(d=>d.task_id===e);if(r!==-1)return i[r].finished=t,i;console.error("Not found task with id ",e)}),push:e=>s(t=>[e,...t]),delete:(e,t,i)=>s(r=>{const d=r.findIndex(f=>f.task_id===e);if(d!==-1)return i?r[d].deleted=t:r.splice(d,1),r;console.error("Not found task with id ",e)})}}export const tasks=p(),subjects=c(tasks,n=>[...new Set(n.map(o=>o.subject).filter(o=>o))]),filtered=c([tasks,u],([n,o])=>{const s=o.filterSubject,e=n.filter(t=>!t.deleted);return s?e.filter(t=>t.subject===s):e}),deleted=c(tasks,n=>n.filter(o=>o.deleted));
