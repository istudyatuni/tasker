import"./TaskItem.svelte.css.proxy.js";import{SvelteComponent as K,append as r,attr as n,component_subscribe as P,create_component as Q,destroy_component as R,detach as z,element as _,empty as U,init as V,insert as D,listen as M,mount_component as W,run_all as X,safe_not_equal as Y,set_data as E,space as O,src_url_equal as S,stop_propagation as Z,text as H,toggle_class as L,transition_in as N,transition_out as A}from"../../snowpack/pkg/svelte/internal.js";import{scriptSanitize as B}from"../utils/sanitize.js";import{isOffline as $}from"../utils/offline.js";import{edit as y}from"../utils/editor.js";import{settings as x}from"../stores/settings.js";import ee from"./DeleteItem.svelte.js";import{FinishTask as te}from"../api/FinishTask.js";import{marked as G}from"../../snowpack/pkg/marked.js";function ie(i){let t,l;return t=new ee({props:{task:i[0]}}),{c(){Q(t.$$.fragment)},m(e,a){W(t,e,a),l=!0},p(e,a){const c={};a&1&&(c.task=e[0]),t.$set(c)},i(e){l||(N(t.$$.fragment,e),l=!0)},o(e){A(t.$$.fragment,e),l=!1},d(e){R(t,e)}}}function J(i){let t,l,e,a=i[0].full_name+"",c,f,p,k=i[0].subject+"",j,q,m,F,h,C,g,I=B(G.parse(i[0].other_text,i[2]))+"",w,v;return{c(){t=_("div"),l=_("div"),e=_("p"),c=H(a),f=O(),p=_("p"),j=H(k),q=O(),m=_("button"),m.textContent="Edit",F=O(),h=_("hr"),C=O(),g=_("div"),n(e,"class","title is-4"),n(p,"class","subtitle"),n(m,"class","button"),n(t,"class","is-flex is-justify-content-space-between mt-5"),L(h,"is-hidden",i[0].other_text===""),n(g,"class","content")},m(s,d){D(s,t,d),r(t,l),r(l,e),r(e,c),r(l,f),r(l,p),r(p,j),r(t,q),r(t,m),D(s,F,d),D(s,h,d),D(s,C,d),D(s,g,d),g.innerHTML=I,w||(v=M(m,"click",i[6]),w=!0)},p(s,d){d&1&&a!==(a=s[0].full_name+"")&&E(c,a),d&1&&k!==(k=s[0].subject+"")&&E(j,k),d&1&&L(h,"is-hidden",s[0].other_text===""),d&5&&I!==(I=B(G.parse(s[0].other_text,s[2]))+"")&&(g.innerHTML=I)},d(s){s&&z(t),s&&z(F),s&&z(h),s&&z(C),s&&z(g),w=!1,v()}}}function le(i){let t,l,e,a,c,f,p,k=i[0].name+"",j,q,m,F=i[0].description+"",h,C,g=$(),I,w,v,s,d,T=g&&ie(i),u=i[1]&&J(i);return{c(){t=_("div"),l=_("div"),e=_("img"),c=O(),f=_("div"),p=_("p"),j=H(k),q=O(),m=_("p"),h=H(F),C=O(),T&&T.c(),I=O(),u&&u.c(),w=U(),S(e.src,a=i[3])||n(e,"src",a),n(e,"class","icon mr-4 pt-1 is-clickable"),n(e,"width","50"),n(e,"height","50"),n(e,"alt",""),n(e,"title","Finish task"),n(e,"role","button"),n(e,"tabindex","0"),n(p,"class","title is-5 svelte-c4fbiz"),L(p,"completed-title",i[0].finished),n(m,"class","subtitle"),n(f,"title","Open details"),n(f,"role","button"),n(f,"tabindex","0"),n(l,"class","level-left"),n(t,"class","level is-clickable")},m(o,b){D(o,t,b),r(t,l),r(l,e),r(l,c),r(l,f),r(f,p),r(p,j),r(f,q),r(f,m),r(m,h),r(t,C),T&&T.m(t,null),D(o,I,b),u&&u.m(o,b),D(o,w,b),v=!0,s||(d=[M(e,"click",Z(i[4])),M(t,"click",i[5])],s=!0)},p(o,[b]){(!v||b&8&&!S(e.src,a=o[3]))&&n(e,"src",a),(!v||b&1)&&k!==(k=o[0].name+"")&&E(j,k),b&1&&L(p,"completed-title",o[0].finished),(!v||b&1)&&F!==(F=o[0].description+"")&&E(h,F),g&&T.p(o,b),o[1]?u?u.p(o,b):(u=J(o),u.c(),u.m(w.parentNode,w)):u&&(u.d(1),u=null)},i(o){v||(N(T),v=!0)},o(o){A(T),v=!1},d(o){o&&z(t),T&&T.d(),o&&z(I),u&&u.d(o),o&&z(w),s=!1,X(d)}}}function se(i,t,l){let e,a,c;P(i,x,m=>l(7,c=m));let{task:f}=t,p=!1;function k(){te(f.task_id,!f.finished)}function j(){l(1,p=!p)}function q(){y("edit",f.task_id)}return i.$$set=m=>{"task"in m&&l(0,f=m.task)},i.$$.update=()=>{if(i.$$.dirty&1){e:l(3,e=`icons/${f.finished?"":"in"}completed-task.svg`)}if(i.$$.dirty&128){e:l(2,a={breaks:!c.strict_line_breaks})}},[f,p,a,e,k,j,q,c]}class ne extends K{constructor(t){super();V(this,t,se,le,Y,{task:0})}}export default ne;
