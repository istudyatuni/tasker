import{SvelteComponent as mt,add_flush_callback as T,append as u,attr as f,bind as q,binding_callbacks as I,component_subscribe as ot,create_component as C,destroy_component as D,detach as it,element as _,init as bt,insert as ut,listen as lt,mount_component as M,run_all as gt,safe_not_equal as vt,space as g,text as ht,toggle_class as at,transition_in as S,transition_out as H}from"../../snowpack/pkg/svelte/internal.js";import{placeholders as L}from"../utils/objects.js";import{edit as kt}from"../utils/editor.js";import{subjects as jt}from"../stores/tasks.js";import{settings as wt}from"../stores/settings.js";import $t from"./blocks/DropdownTextInput.svelte.js";import z from"./blocks/TextInput.svelte.js";import{UpdateTask as xt}from"../api/UpdateTask.js";import{SendNewTask as Tt}from"../api/CreateTask.js";function qt(e){let i;return{c(){i=_("span"),i.innerHTML='<img src="icons/markdown.svg" title="Markdown is supported" alt=""/>',f(i,"class","icon"),f(i,"slot","after-label")},m(o,v){ut(o,i,v)},d(o){o&&it(i)}}}function It(e){let i,o,v,p,s,a,l,d,j,N,c,w,U,n,A,O,m,B,P,b,E,Q,k,$,R,h,V,F,x,G,W;function pt(t){e[5](t)}let X={label:"Name",placeholder:L.name,required:!0};e[0].name!==void 0&&(X.value=e[0].name),d=new z({props:X}),I.push(()=>q(d,"value",pt));function dt(t){e[6](t)}let Y={label:"Full name",placeholder:L.full_name};e[0].full_name!==void 0&&(Y.value=e[0].full_name),c=new z({props:Y}),I.push(()=>q(c,"value",dt));function ct(t){e[7](t)}let Z={label:"Subject",placeholder:L.subject,dropdown:e[2]};e[0].subject!==void 0&&(Z.value=e[0].subject),n=new $t({props:Z}),I.push(()=>q(n,"value",ct));function ft(t){e[8](t)}let y={label:"Description",placeholder:L.description};e[0].description!==void 0&&(y.value=e[0].description),m=new z({props:y}),I.push(()=>q(m,"value",ft));function _t(t){e[9](t)}let tt={label:"Detailed description",placeholder:L.other_text,big_text:!0,markdown:!0,$$slots:{"after-label":[qt]},$$scope:{ctx:e}};return e[0].other_text!==void 0&&(tt.value=e[0].other_text),b=new z({props:tt}),I.push(()=>q(b,"value",_t)),{c(){i=_("div"),o=_("div"),v=g(),p=_("div"),s=_("header"),s.innerHTML='<p class="modal-card-title">Task editor</p>',a=g(),l=_("section"),C(d.$$.fragment),N=g(),C(c.$$.fragment),U=g(),C(n.$$.fragment),O=g(),C(m.$$.fragment),P=g(),C(b.$$.fragment),Q=g(),k=_("footer"),$=_("button"),$.textContent="Cancel",R=g(),h=_("button"),V=ht("Save changes"),f(o,"class","modal-background"),f(s,"class","modal-card-head"),f(l,"class","modal-card-body"),f($,"class","button"),f(h,"class","button is-success"),h.disabled=F=!e[0].name,f(k,"class","modal-card-foot is-flex is-justify-content-flex-end"),f(p,"class","modal-card"),f(i,"class","modal"),at(i,"is-active",e[1])},m(t,r){ut(t,i,r),u(i,o),u(i,v),u(i,p),u(p,s),u(p,a),u(p,l),M(d,l,null),u(l,N),M(c,l,null),u(l,U),M(n,l,null),u(l,O),M(m,l,null),u(l,P),M(b,l,null),u(p,Q),u(p,k),u(k,$),u(k,R),u(k,h),u(h,V),x=!0,G||(W=[lt($,"click",rt),lt(h,"click",e[3])],G=!0)},p(t,[r]){const et={};!j&&r&1&&(j=!0,et.value=t[0].name,T(()=>j=!1)),d.$set(et);const nt={};!w&&r&1&&(w=!0,nt.value=t[0].full_name,T(()=>w=!1)),c.$set(nt);const J={};r&4&&(J.dropdown=t[2]),!A&&r&1&&(A=!0,J.value=t[0].subject,T(()=>A=!1)),n.$set(J);const st={};!B&&r&1&&(B=!0,st.value=t[0].description,T(()=>B=!1)),m.$set(st);const K={};r&2048&&(K.$$scope={dirty:r,ctx:t}),!E&&r&1&&(E=!0,K.value=t[0].other_text,T(()=>E=!1)),b.$set(K),(!x||r&1&&F!==(F=!t[0].name))&&(h.disabled=F),r&2&&at(i,"is-active",t[1])},i(t){x||(S(d.$$.fragment,t),S(c.$$.fragment,t),S(n.$$.fragment,t),S(m.$$.fragment,t),S(b.$$.fragment,t),x=!0)},o(t){H(d.$$.fragment,t),H(c.$$.fragment,t),H(n.$$.fragment,t),H(m.$$.fragment,t),H(b.$$.fragment,t),x=!1},d(t){t&&it(i),D(d),D(c),D(n),D(m),D(b),G=!1,gt(W)}}}const Ct={close:()=>!0,create:Tt,edit:xt};function rt(){kt("close")}function Dt(e,i,o){let v,p,s,a,l;ot(e,wt,n=>o(4,a=n)),ot(e,jt,n=>o(2,l=n));async function d(){if(!s.name)return;await p(s)===!0&&rt()}function j(n){e.$$.not_equal(s.name,n)&&(s.name=n,o(0,s),o(4,a))}function N(n){e.$$.not_equal(s.full_name,n)&&(s.full_name=n,o(0,s),o(4,a))}function c(n){e.$$.not_equal(s.subject,n)&&(s.subject=n,o(0,s),o(4,a))}function w(n){e.$$.not_equal(s.description,n)&&(s.description=n,o(0,s),o(4,a))}function U(n){e.$$.not_equal(s.other_text,n)&&(s.other_text=n,o(0,s),o(4,a))}return e.$$.update=()=>{if(e.$$.dirty&16){t:o(1,v=a.editor.state!=="close")}if(e.$$.dirty&16){t:p=Ct[a.editor.state]}if(e.$$.dirty&16){t:o(0,s=a.editor.task)}},[s,v,l,d,a,j,N,c,w,U]}class Mt extends mt{constructor(i){super();bt(this,i,Dt,It,vt,{})}}export default Mt;
